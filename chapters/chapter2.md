# 攻撃手法ありすぎ問題

本章では、情報セキュリティの初学者を苦しめるであろう攻撃手法の多様さについて考えます。すべての攻撃手法を語ることはできませんが、初学者がどのように付き合っていけばよいかを解説します。

## 攻撃手法を学ぶことの難しさ

情報セキュリティを勉強しはじめると、さまざまな攻撃手法と出会います。そして、それらの攻撃は日々アップデートされるため、その数は無限とも思えます。

たとえば、「トロイの木馬」というマルウェアを知っている方は多いでしょう。しかしながら、「リモートアクセス型トロイの木馬（RAT）」と言われてもピンとこない方が多いでしょう。

トロイの木馬といえば、表面上は無害だったり、有益なソフトウェアに偽装してターゲットのデバイス内に侵入します。そして、何かしらのトリガーをきっかけとして攻撃を開始する性質をもったマルウェアのことです。

RATは、ベースはトロイの木馬と同じですが、攻撃者がネットワークを介してリモートアクセス可能であることで特徴づけられます。RATは2016年頃からその感染数を増やし始めているそうです。

このように、攻撃者は常にツール（マルウェア）をアップデートしていますし、攻撃手法も日々新しいものが考え出され、攻撃に使用されています。我々のような情報セキュリティの初学者は、情報量の多さに圧倒され、やる気を失っていくことになるのです。

## 攻撃手法との向き合い方

初学者が攻撃手法の多様さに圧倒されることは無理もありません。実際、この世には無限ともいえる数の攻撃手法が存在しますし、それらの攻撃手法を実現するための攻撃ツールもまた無数に（そして、その亜種も）存在します。

本書を手にとってくださったみなさんが何を目指しているかにも依りますが、セキュリティのプロフェッショナルの中でもマルウェアの解析者やペネトレイトテスター、Red Teamにでもならない限り、攻撃手法を詳細に知る必要はないでしょう。

しかしながら、攻撃手法を分類して把握できる能力は鍛えておくべきです。たとえば、マルウェアは「ウィルス」「ワーム」「トロイの木馬」のように分類されるもの、くらいのカテゴライズ能力は必要です。簡単な情報セキュリティ用語ですが、説明できる人は案外少ないものです。ある日突然、上長から「マルウェアとウィルスは何が違うんだ？」と聞かれてもあたふたしなくなります。また、2019年後半から大流行しているEmotetはウィルスに分類されるもの、くらいにカテゴライズして認識できていれば、「対策にはウィルス対策ソフトが有効なのか」や「どうやって感染拡大しているのだろうか」などと次の疑問への取っ掛かりとしやすいです。

大量の情報を与えられたときは、慌てずひとつひとつを分類して認識しやすいレベルまで咀嚼する習慣をつけるようにしましょう。

## 本章を読み進めるための道標

本章では具体的な攻撃手法を一緒にみていきましょう。

「攻撃手法」と一口にいっても千差万別、まずはこれから進む大海を俯瞰してみてください。

![](https://github.com/oresama-lab/img/blob/master/handbook-of-information-security/chapter2/overall.png?raw=true)

念の為、改めて説明しておきますが、ここに示した図はあくまで2020年2月時点での筆者から見えている情報セキュリティの攻撃手法の世界をカテゴライズしたものです。決して「これが正解」というような性質のものではないこと、ご認識の上この先を御覧くださいませ。

本書では、攻撃手法を学ぶために必要な要素を5つにカテゴライズしました。

* 攻撃者
* 攻撃の流れ
* 攻撃の種類
* 攻撃の手法
* 攻撃に使われるツール

それぞれの内容を簡単にご紹介します。

### 攻撃者

攻撃者といってもそのタイプはさまざまです。企業から情報を盗もうとしている攻撃者もいれば、愉快犯のような攻撃者もいます。ここでは、攻撃者の種類とその目的について説明します。

### 攻撃の流れ

攻撃にはある程度のパターン（流れ）が存在します。世の中にはその流れをフレームワーク化したものがいくつか存在しますので、今回はその中から3つ取り上げてご紹介します。

### 攻撃の種類

ここでは攻撃者が仕掛ける攻撃の種類を見ていきます。主には標的型攻撃について触れます。標的型攻撃とは何なのか、その他の攻撃にはどんな種類があり、標的型攻撃とは何が違うのかを説明します。

### 攻撃の手法

いよいよ攻撃の手法を解説します。ここでは攻撃手法を「物理的な攻撃」「システム利用者を狙った攻撃」「偽装・隠蔽」「システムを狙った攻撃」「不正アクセス」「サービス妨害」の6個に分類し、具体化を進めます。

### 攻撃に使われるツール

攻撃者は攻撃に使うすべてのツールを自作しているわけではありません。私たちも入手可能なツールもあれば、ダークウェブ等で売買されているエクスプロイット・キットのようなツールも存在します。攻撃者はこれらのツールを組み合わせ、時には改良してさまざまな攻撃を仕掛けます。攻撃者が使うツールを知ることで、攻撃者に対する理解を深めます。

これからたくさんの情報が出てきますが、さいごに本章を振り返るまとめを用意していますので、嫌な顔をせずに読み進めていただければと思います。

それでは、実際に中身を見ていきましょう。

## 攻撃者

まずは、攻撃者について見ていきましょう。

### 攻撃者の種類

本書では、以下2つの観点から攻撃者を分類します。

* 攻撃者の規模による分類
* 攻撃者のタイプによる分類

#### 攻撃者の規模による分類

攻撃者はその規模から3種類に分類されます。

* 個人
* 犯罪組織
* 国家

それぞれどのような目的をもって活動しているのか見てみましょう。

<ToDo：表を入れる>

クラッカー（ハッカー）と言われてイメージするのは個人で活動する攻撃者ではないでしょうか。いわゆる天才で、深い技術的知識を持つことが多いとされます。何かしらの目的をもって不正行為を行いますが、大した目的はなく、単に自分の実力を見せつけたいような愉快犯も存在します。愉快犯による攻撃は、Webサイトへの声明の記載（改ざん）のような比較的害の少ないものから、Webサービス等を停止させるような大規模な攻撃までさまざまです。

次に犯罪組織です。企業/個人から情報を窃取したり、企業/個人から金銭を不正に入手したりすることを目的とし、組織的に活動します。規模としては、数名から数百名までばらつきがあります。

最後に国家です。いわゆる高度標的型攻撃（APT攻撃）の背後には国家、もしくは国家に匹敵する規模の組織が潜んでいるとされています。国家がバックについていることで、巨額の予算がつくため、国家機密等の重大な情報の窃取や重要インフラ情報（電気・ガス・水道のようなライフラインや原子力発電施設のような重大施設に関する情報、防衛情報など）の窃取やそれに基づいた妨害攻撃を達成することを目的としています。

### 攻撃者のタイプによる分類

攻撃者といえばハッカーという図式が頭の中にある方もいらっしゃるのではないでしょうか。たしかに一昔前はハッカーという言葉が一般的でしたが、近年では不正行為を働き、害を与える存在はクラッカーと呼ぶのが通例となっているそうです。ただ、ハッカーという呼び名がなくなったわけではなく、以下7種類に分類する例もあります。

* スクリプトキディー
* グリーンハットハッカー
* ブルーハットハッカー
* ブラックハットハッカー
* ホワイトハットハッカー
* グレーハットハッカー
* ハクティビスト

スクリプトキディーというのは、いわゆる「お子ちゃま」のことで、ハッキングスキルは低く、多くの場合特別な目的も持たない攻撃者のことを指します。自身でハッキング行為を行うというよりは、既成のツールを使ってDDoS攻撃を行うだけだったり、簡易な攻撃を試して満足するようなタイプとされています。

低レベルのハッカーにはグリーンハットハッカーやブルーハットハッカーと呼ばれるタイプもいます。

グリーンハットハッカーは、スクリプトキディーと比べて成長意欲が高く、ハッキングスキルを習得・練習・改善するために努力するタイプのことを言います。

ブルーハットハッカーは、根本的にはスクリプトキディーと変わりません。ただし、明確な標的を持っており、標的に対する復讐心が高いタイプとされています。

ブラックハットハッカーが、いわゆる一般人がイメージする攻撃者です。技術的スキルが高く、悪意をもって攻撃を仕掛けるタイプです。一般に「ハッキングに伴うスキルを楽しむ」タイプとされており、ブラックハットハッカー同士での競争も激しいとされています。

ホワイトハッカーは、エシカルハッカー（Ethical Hacker：倫理的なハッカー）とも呼ばれ、悪と戦うことを目的としたハッカーです。たとえば、ソフトウェアの脆弱性調査を行って、攻撃者よりも先に脆弱性を見つることで、ゼロデイ攻撃の発生を防ぐような活動を行っています。

グレーハットハッカーは、ホワイトハットハッカーとブラックハットハッカーの両方の特性をもつハッカーのことです。ホワイトハットハッカーのように正義のために闘うという感じではなく、いわゆる法律的/倫理的に「グレー」な行いを行う者とされています。

ハクティビストは過激派と理解してもらっても良いだろう。日本人的にわかりやすい例でいうと反捕鯨団体として有名なグリーンピースだったり、国際的なハクティビスト集団であるアノニマスが挙げられます。特定の信条を貫き通すためには手段をいとわない過激さをもっていることが特徴的です。

### おれさまラボ的分類図

ここまでの説明を、おれさまラボ的には以下の図のように捉えます。

![](https://github.com/oresama-lab/img/blob/master/handbook-of-information-security/chapter2/attackers.png?raw=true)

一般に、脅威と捉えるのは半分より上側に位置するブラックハットハッカー、グレーハットハッカー、ハクティビストでしょう。ブラックハットハッカーは個人で動く者から組織的に動くもの、そして国家から雇われている者とその規模はさまざまと考えられます。グレーハットハッカーも、時にはブラックハットに転身してしまうことから、規模としてはブラックハットハッカーと同一に分類しています。対して、ハクティビストは、個人的/政治的信条をもとに結束した集団であるため、国家規模には分類していません。

また、グレーハットハッカーは、ホワイトハットハッカーとしての一面も持つため脅威レベルとしては下げつつも、ブラックハットハッカーに転身するリスクがあるため、脅威レベルは高めにしています。

スクリプトキディ、グリーンハットハッカー、ブルーハットハッカーは技術的能力が低いことから脅威レベルは低いとし、ホワイトハッカーは正義のために動くため脅威にはならない分類としています。

## 攻撃の種類

次に、攻撃の種類について見ていきましょう。

### 標的型攻撃

標的型攻撃とは、特定のターゲットに狙いを定めて執拗に攻撃を仕掛けるサイバー攻撃のことを言います。

標的型攻撃には以下の特徴があります。

* ステルス性の高い攻撃（潜伏期間が長い）
* ソーシャルエンジニアリングを利用した巧みな手口
* 国家を背景とした攻撃組織
* 狙われる産業：　防衛、航空、宇宙、機械、化学、病院、公的機関、エネルギー、報道機関など
* 攻撃というより情報を狙った諜報活動（スパイ活動）に近い

標的型攻撃においては、実行ファイルやマイクロソフトOffice製品のマクロを組み込んだファイルをメールで送りつけターゲットとなる企業や個人に開かせるような攻撃手法が用いられます。とくに、企業においてはITリテラシーの低い従業員が攻撃であるとは気が付かずに添付ファイルを開いてしまい、被害につながるケースが多いとされています。

第1章で学んだ、ヒトが脆弱性となるケースに当たります。IT管理者が制御しきれないメールを使って、ITリテラシーの低い従業員を狙うことで組織内に攻撃性の高いツールを送り込む非常にやっかいな攻撃手法です。

#### 高度標的型攻撃（APT攻撃）

高度攻撃型攻撃は、標的型攻撃と基本的な考えは同じですが、攻撃手法が高度かつ持続的なものを言います。APT攻撃とも呼ばれ、Advanced（高度で）、Persistent（執拗な）、Threat（脅威）の頭文字がその由来となっています。

従来は、国家の後ろ盾があるような攻撃者からの攻撃をAPT攻撃と分類していましたが、近年は国家に限らず、特定の目的のために大規模な攻撃を仕掛ける組織によるAPT攻撃も増加しているとのことです。これは、限られた攻撃車によって使われていた高度な攻撃ツールが広く拡散し、低レベルな攻撃者であっても扱えるようになったことが原因とされています。

### ばら撒き型攻撃

標的型攻撃に対して、ターゲットを特定しない攻撃をばら撒き型攻撃と言います。ランサムウェアのような攻撃ツールをメール等の手段で不特定多数にばら撒き、誰かが引っ掛かるのを待つ手法です。

なお、ややこしいのですが、標的型攻撃においてもばら撒き型攻撃が使われるケースもあります。特定の組織の従業員全員に対して一斉に悪意のあるメールを送信するような場合がこれにあたります。一方で、標的型攻撃の場合は取引先相手になりすまして実際にターゲットとメールのやりとりをする場合もあります。このような攻撃手法は**やりとり型攻撃**と呼ばれることがあります。

## 攻撃の流れ

攻撃する主体である攻撃者とその種類がわかったところで、今度は攻撃の流れを見ていきましょう。

### サイバーキルチェーン

サイバーキルチェーンは、2009年にロッキード・マーチン社によって発表された標的型攻撃における攻撃者の動きを分類したものです。キルチェーンという言葉はもともと軍事用語で「負の連鎖を断ち切る」という意味を持つそうです。サイバーキルチェーンでは、攻撃者の動きを以下7つに分類しています。

* 偵察（Reconnaissance）
* 武器化（Weaponization）
* 配送（Delivery）
* 攻撃（Exploitation）
* インストール（Installation）
* 遠隔操作（Command & Control）
* 目的の実行（Actions on Objectives）

#### 偵察

偵察は以下2つに分類されます。

* 隠密偵察
* 威力偵察

隠密偵察は、組織内部の情報を入手することを目的に行われます。たとえばターゲットの組織図であったり、ネットワーク構成図のようなものの入手が目的となります。Webや文書等で公開されている情報からも得られるものは多く、入念に調査が行われます。また、必要に応じてネットワーク経由での侵入や内部関係者との接触によって、機密情報を入手することもあります。

威力偵察とは、たとえば継続的なポートノックや小規模な攻撃を仕掛け、それらに対する組織の対応を観察することです。不審な動きに対して組織が対応に手間取っているのであれば、より大きな攻撃を仕掛けても成功する可能性が高いと判断されます。

#### 武器化

偵察により入手した情報に基づき、ターゲットを攻撃するのに適したマルウェアや配送手段（メールや偽装Webサイトなど）を検討/実装します。

#### 配送

武器化したツールを、ターゲット組織内に侵入させるフェーズです。詳細は後述しますが、USBのような物理媒体であったり、偽装Webサイトへのアクセスを促すなど、その方法は多岐に渡ります。

#### 攻撃

配送した悪意のあるツールを実行するフェーズになります。

#### インストール

悪意のあるツールの実行が成功し、端末に悪意のあるツールがインストールされるフェーズです。ツールの性質によって挙動は異なりますが、感染拡大を自発的に行ったり、攻撃者が新たな攻撃を行うためのバックドアを仕掛けたりする活動が行われます。

#### 遠隔操作

インストールされた悪意のあるツールと組織外部に設置されたC&Cサーバが通信可能な状態となるフェーズです。攻撃者によってインストールされたツールが新たな攻撃を開始する司令を受け取ったり、攻撃者がターゲット端末にリモートアクセスできる可能性があります。

#### 目的の実行

サイバーキルチェーンの最終フェーズです。攻撃者は情報の窃取やファイルの改ざん、データの破壊、サービスの停止/妨害などの目的を達成します。

### APT活動モデル（JPCERT/CC）

次に紹介するのは、日本の情報セキュリティ団体であるJPCERTコーディネーションセンター（JPCERT/CC）によって作成されたAPT活動モデルです。

JPCERT/CCでは、APT攻撃を以下のとおり定義しています。

![](https://github.com/oresama-lab/img/blob/master/handbook-of-information-security/chapter2/apt_definition.png?raw=true)

APT活動モデルは、セキュリティチームではなく、企業の役員や一般従業員への説明を意図して作成されたモデルです。そのため、サイバーキルチェーンと比べるとステップ数が少なく、4段階のアプローチでまとめられています。

* 第1段階： 準備
* 第2段階： 潜入
* 第3段階： 横断的侵害
* 第4段階： 活動

#### 第1段階： 準備

APT活動モデルでは、準備活動を以下のように表現しています。

```
攻撃者は標的組織への侵入の前に入念に調査し侵入の手筈を整える。
```

準備フェーズでは以下のような活動が実施されます。

* 攻撃者の所在地や目的を隠蔽するグローバル規模の分散型インフラの構築
* 標的組織の機密情報を収集する
* 過去の活動から得られた教訓をもとに侵入経路や攻撃手法を改善する
* 攻撃に利用可能な文書を収集する ※後に標的型攻撃でメール等に添付して利用するため

また、可能であれば防御側の法律的な制約を利用するともされています。たとえば、米国では、米国防総省が米国民に関する機密情報を収集することが法律で禁じられている。つまり国防総省は、攻撃者が米国内に用意した攻撃システムを合法的に操作することができない。このようにして、防御側に気づかれないよう準備を進めるとされています。

#### 第2段階： 潜入

攻撃者は、防御側から補足されないように露出を最小限にして侵入を試みようと考えます。

資金を十分にもつAPT攻撃者であれば、事前の情報収集によってターゲットの組織体制、ネットワーク構成、セキュリティ上の欠陥が存在するかを確認済みであり、それらの情報をもとに組織内へ潜入します。

資金が十分でない場合は、ネットワークからの侵入を試みる場合もありますが、ファイアウォールやIDSなどのネットワークセキュリティ機器をくぐり抜ける必要があるため、攻撃が目立ってしまう可能性があります。

目立たない高度な侵入方法としては、正規の認証情報を使って侵入する方法が取られます。

* フィッシングメールを使って偽Webサイトへ誘導し正規の認証情報を窃取する
* 脆弱な周辺システムから侵入し、ターゲット組織と周辺システムとのトラストチェーンを利用する

組織内に潜入できてしまえば、攻撃者の最終目的を達成できる可能性が高まりますので、侵入されない対策を講じることが非常に大切とされます。

#### 第3段階： 横断的侵害

攻撃者が最初に潜入する端末は多くの場合、最終目的地である可能性は低いとされています。そのため、攻撃者は最初に侵入した端末を足がかりとして内部からネットワーク構造を探り、他の脆弱なシステムへ横断的侵害を繰り返します。多くの組織では、インターネット境界には強固な防御設備を用意していますが、内部ネットワークのセキュリティは甘いケースが多いため、初期の潜入に比べると横断的侵害は比較的目立たずに進められるとされます。

#### 第4段階： 活動

やがて、攻撃者は最終目的を達成するための準備を整え、目標とする情報の窃取や破壊活動等を行います。

### 高度標的型攻撃の全容（IPA）

情報処理推進機構（IPA）からも高度標的型攻撃（APT攻撃）の基本パターンが公表されています。ここではAPT攻撃を7段階のステップで説明されています。

* 計画立案
* 攻撃準備
* 初期潜入
* 基盤構築
* 内部侵入・調査
* 目的遂行
* 再侵入

なお、本ステップは『高度標的型攻撃』対策に向けたシステム設計ガイド（2014, IPA）へ記載されていますが、この設計ガイドによると「初期潜入」の手口は巧妙化しているため、侵入されることを前提とした「基盤構築」「内部侵入・調査」対策を重視する必要性を説いています。

IPAによるこの7段階のステップでは、1つ1つのステップに攻撃が存在し、一連の攻撃の結果として攻撃者が最終目的を達成することが明記されていたため今回取り上げました。たとえば「計画立案は攻撃者の準備フェーズだから防御側は手出しできない」と考えるのは危険で、「計画立案では、攻撃者が最終目的を達成するために必要な情報（正規の認証情報など）を窃取する活動を防ぐ」必要があると認識することが大切です。

#### 計画立案

攻撃者は、最終目的を達成するまでの一連の攻撃の基となる情報の収集を行います。公開情報からの情報収集はもちろん、インターネット上からの個人情報の収集や関連組織への攻撃などが含まれます。

#### 攻撃準備

攻撃者は、組織内部へ侵入するための攻撃環境を構築します。具体的には標的型メールを作成したり、C&Cサーバの準備を行ったりします。C&Cサーバは、クラウドの発達によって世界中に容易に構築することができるようになったこともあり、身元を隠蔽するためにグローバルに分散して構築されます。

#### 初期潜入

ターゲット組織の端末にマルウェアを確実に感染させることを目的に、攻撃を行います。多くの場合、標的型メールを送付して、添付されたマルウェアをユーザに実行させます。

#### 基盤構築

マルウェアが端末上で実行されると、マルウェアはC&Cサーバとの通信を試みます。これは、リモートコントロール通信経路（コネクトバック通信）の確立と呼ばれます。コネクトバック通信が確立すると、攻撃者はネットワーク越しに自由に端末を操作できるようになります。

#### 内部侵入・調査

マルウェア侵害した端末を起点に、ID/パスワード情報を窃取しながら他の端末やサーバへと侵害を拡大します。

#### 目的遂行

攻撃者の最終目的を達成する準備が整うと、攻撃者は情報の窃取やシステムの破壊活動などを開始します。この段階までくるとシステム全体が攻撃者の手中にある可能性が高く、実害を回避することは困難とされています。

#### 再侵入

攻撃者はさらなる攻撃に備えて、コネクトバック通信経路を確保したままにする可能性があります。一度標的になった組織は、攻撃が収まったからといって安心することはできず、コネクトバック通信経路が残されていないか入念に確認する必要があります。

## 侵入経路

ここからは、攻撃者がどこから攻撃をしかけてくるのか、その経路について説明します。

### インターネット

攻撃者が悪意をもった第三者である場合、インターネットから侵入を試みてくることが一般的です。

#### リモートアクセス

インターネット経由で、攻撃対象のサーバやネットワーク機器、PCへリモートアクセスするケースです。さすがに今どき、インターネットから直接接続できる端末では何かしらのアクセス制御がおこなわれているはず（やっていなかったらヤバい）ですが、そのような状態でも攻撃者がリモートアクセスできる環境を整えることは可能です。

ひとつには、OSやソフトウェア、アプリケーションの脆弱性を突くことによって攻撃対象端末に接続する方法があります。たとえば、外部公開されたシステムがあったとして、そこで提供されているWebアプリケーションにOSコマンド・インジェクションが実行可能な脆弱性があったとします。攻撃者はその脆弱性を利用して任意のOSコマンドを実行することが可能となり、継続的にリモートアクセスできる環境を整えるられる可能性があります。

また、昨今はやりの標的型メールを使って、PCにマルウェアを感染させて、コネクトバック通信によってリモートアクセス環境を整えるケースもありえます。コネクトバック通信とは、PC側からの発信によりファイアウォールをすり抜けることで、該当のPC（ネットワーク）がバックドアに変えてしまう仕組みです。

ここで、コネクトバック通信を補足しておきます。

コネクトバック通信を理解するにはネットワーク知識が必要です。具体的には、TCPとネットワーク・ファイアウォールの仕組みの理解が必要となります。

TCPには3-way-handshakeと呼ばれる仕組みあります。これは、TCPセッションを確立するには①SYN、②SYN+ACK、③ACKという3つのステップを踏む必要があるという仕組みです。

TODO：＜図を入れる＞

一方、ネットワーク・ファイアウォールにはステートフルであるという特徴があります。ステートフルとは、TCPセッション全体の流れを理解することができる仕組みのことで、対義語はステートレスです。ステートレスなファイアウォールは、TCPセッション全体の流れを理解することができないので、通信ポリシーを作成する際に、双方向の通信を定義してあげる必要があります。ステートフルなファイアウォールであれば、TCPセッション全体の流れを理解することができるので、通信が発生する方向のみを定義しておけば、その逆方向の通信もよしなに許可/拒否してくれる仕組みです。

TODO：＜図を入れる＞

ステートフルなファイアウォールでは、一般的に、外部ネットワークから内部ネットワークへのアクセス制御は厳しく、内部ネットワークから外部ネットワークへのアクセス制御は甘くなる傾向にあります。これは、TCP通信でPCが使用するポートを特定することが難しいためです。

たとえばあるWebサーバにアクセスする場合、一般にHTTPであれば80番ポート、HTTPSであれば443番ポートにアクセスすることとなります。つまり、TCP 3-way-handshakeのSYNパケットの宛先ポートには80番もしくは443番がセットされることを意味します。では、送信元のポート番号は何になるでしょうか。一般にエフェメラルポート（一時ポート/一時割当ポート）が用いられます。OSによってその範囲はまちまちですが、広義にはいわゆるウェルノウンポート（0番-1023番）より後ろの番号（1024番-65535番）のことを指します。

TODO：＜表を入れる＞：RFC6056、Linux、Windows

Webアクセスに限りませんが、エフェメラルポートは動的に割り当てられ、特定の1ポートが必ず使われるということはありません。そのため、ファイアウォールポリシーで定義する送信元アドレスを最小化することは難しく、ゆるゆるの状態となります。

また、WebアクセスするPCは多くの場合1台ではなく、その組織の人数分以上のPCが存在するはずです。1台1台のIPアドレスをファイアウォールポリシーに追加することは大変ですし、機器の上限値に掛かる可能性もあります。さらにいえば固定IPアドレス運用なら良いですが、DHCP運用をしている場合はIPアドレスが動的に変わりますので、送信元アドレスも最小化することは難しいと言えます。

宛先アドレスはインターネット上に無限に存在するので、ほぼALL Permit（全開放）とする以外方法がありません。

さらに、Webサーバであれば一般にHTTPであれば80番ポート、HTTPSであれば443番ポートを使用しますが、セキュリティ上の理由（攻撃を受ける可能性を最小化する目的）から別のポート番号に変えているサイトも存在しますので、宛先ポート番号も最小化して定義することは難しいです。

こういった意味で、内部ネットワークから外部ネットワークへのアクセス制御は甘くなる傾向があります。

コネクトバック通信に話を戻します。コネクトバック通信は、内部ネットワークから外部ネットワークへのアクセス制御が甘くなる傾向を悪用した仕組みです。何かしらの方法で内部ネットワークに侵入したマルウェアは攻撃者の用意したサーバ（C&Cサーバ）に対してコネクトバック通信を試みます。コネクトバック通信への対策が施されていなければ、簡単にC&Cサーバへの接続を確立する（セッションを張る）ことができるでしょう。攻撃者は外からセッションを張る必要がなく、内部ネットワークから張られたTCPセッションを使って、引き続きマルウェアに対して司令を送ったり、PCの制御を奪ったりすることが可能となります。

このように、攻撃者は脆弱性を突いてリモートアクセス経路を確立したり、内部ネットワークからリモートアクセス経路を確立する可能性があります。これらへの対策は次の章で触れますが、前者であればインターネットへ直接公開するサーバを減らしたり、できる限り脆弱性をなくす対策が有効です。また、後者に関しては、これからお話する侵入経路を潰していくことが有効な対策となるでしょう。

#### メール

メールは広く普及した便利な連絡手段である一方、古くからマルウェア等の侵入経路としても機能してきました。2019年後半頃から世間を賑わせているEmotetも、メールを巧みに利用することで感染端末数を拡大していますね。

メールを使った攻撃者の侵入はいくつかの手法に分けられます。

* マルウェアの添付
* 悪性URLの埋め込み
* なりすまし

マルウェアの添付は昔からある攻撃手法なので、みなさんもイメージがつきやすいと思います。昔は、実行形式のファイル（.exe等）がそのまま添付されていましたが、ITリテラシーの高まりによって誤って実行してしまう人の割合が減ったり、メーラー側に添付や実行を阻止する機能が備わっていたりすることでこのようなタイプは最近見かけないように思います（データなくてすみません）。少し進化した例では実行形式のファイルをZIP圧縮して送る例もありました。これも最近はあまり見かけません。少し前には、Powershellスクリプトを悪用した攻撃例が多く見られました。最近では、Microsoft社 Office Suiteのマクロ機能を悪用した攻撃が多くなっているようです。

悪性URLの埋め込みはHTMLメールが一般化したことで登場した攻撃手法です。HTML形式でメールを記述する場合、リンクタグを用いてURLを埋め込むことができます。このとき、見た目上は問題ないサイトへのアクセスに見えても実際のアクセス先は悪性サイトであったということが起こりえます。悪性サイトへの誘導方法はさまざまですが、単純に「詳細はこちら」のような文字列と悪性サイトのリンクを関連付けたり、紛らわしいURL（http://example.co.jpが正規サイトだとするとhttp://example.coという悪性サイトを用意するなど）を使用するケースもあります。こういった攻撃は「フィッシング詐欺」や「クリック詐欺」に使われることがあります。

なりすましは、近年非常に多く観測されている手法です。ばらまき型の攻撃では「賞与に関するお知らせ」のような引っかかりやすいタイトルで興味を引くケースがありますし、標的型であればソーシャルエンジニアリングや中間車攻撃によりあらかじめ取引先やメールの内容を把握しておき、タイミングを見計らって送信元を取引先とアドレスと詐称したメールを送りつけ、口座への振り込み等による金銭の奪取や情報の摂取が行われるケースもあります。

#### Webサイト

Webサイトは、これまで紹介したリモートアクセスやメールと組み合わせて使用されることが多いものです。正確には「侵入経路」の分類ではないのですが、他の侵入経路と密接に関わる手法なので、ここでは大きく2つに分けて紹介します。

* 偽Webサイト
* Webサイトの改ざん
* 悪性Webサイト

偽Webサイトでは、攻撃者が用意したWebサイトに攻撃対象ユーザを誘導するケースが挙げられます。メールで紹介した悪性URLの埋め込みと関連するケースが一番イメージがつきやすいでしょう。たとえば、銀行サイトの偽サイトを用意しておき、ユーザを偽サイトに誘導して正規の資格情報（ログイン情報）を摂取する手法があります。

Webサイトの改ざんはコーポレートサイトなど、インターネットに公開されたサイトに侵入され、サイトの情報を書き換えられたしまう攻撃です。誤った情報を配信してしまったり、偽Webサイトへ誘導するようサイト構成やURLの書き換えが行われる可能性があります。

最後に悪性Webサイトでは、アクセスしてしまったユーザーの端末にマルウェアをインストールさせるケースが考えられます。

### 物理媒体

#### USB

#### PCの持ち込み

#### 紙媒体からの情報窃取

## 攻撃の手法

## 攻撃に使われるツール

## 攻撃の手法

### システム利用者を狙った攻撃

#### フィッシング

#### Wiフィッシング

#### QRコードフィッシング

#### ビジネス詐欺（BEC）

#### ワンクリック詐欺

#### 不正送金ウィルス

##### マン・イン・ザ・ブラウザ

##### クリック・ジャッキング

##### ランサムウェア

##### スケアウェア

##### ローグウェア

#### 水飲み場攻撃

#### ドライブ・バイ・ダウンロード

### 隠蔽・偽装

#### スプーフィング

##### IPスプーフィング

##### DNSスプーフィング

###### DNSキャッシュポイズニング

カミンスキー攻撃

###### ドメイン・ハイジャック

#### ファーミング

##### ドライブ・バイ・ファーミング

### システムを狙った攻撃

#### バッファ・オーバー・フロー

#### コード・インジェクション

##### SQLインジェクション

##### OSコマンド・インジェクション

##### JavaScriptインジェクション

#### データ・インジェクション

##### メールヘッダ・インジェクション

##### HTTPヘッダ・インジェクション

##### ディレクトリ・トラバーサル攻撃

#### リクエスト・インジェクション

##### クロス・サイト・リクエスト・フォージェリ（CSRF/XSRF）

##### サーバ・サイド・リクエスト・フォージェリ（SSRF）

#### クロス・サイト・スクリプティング（XSS）

### 不正アクセス

#### パスワードの不正使用

##### 攻撃の種類

###### パスワード・スプレー攻撃

###### ブルート・フォース攻撃

###### パスワード・リスト攻撃

###### リバース・ブルート・フォース攻撃

###### パス・ザ・ハッシュ攻撃

##### オンライン攻撃とオフライン攻撃

#### セッション・ハイジャック攻撃

##### セッションIDの推測

##### セッションIDの奪取

##### セッションIDの固定化（セッション・フィクセーション攻撃）

##### TCPシーケンス番号予測攻撃

##### DNSピニング攻撃（DNSリバインディング攻撃）

### サービス妨害

#### DoS攻撃

#### DDoS攻撃

##### ネットワーク資産消費型

##### ICMPフラッド攻撃

###### UDPフラッド攻撃

###### TCPフラッド攻撃

##### システム資産消費型（スロー攻撃）

###### SYNフラッド攻撃

###### HTTPフラッド攻撃

##### リフレクション攻撃（アンプ攻撃）

###### DNSリフレクション攻撃

###### NTPリフレクション攻撃

###### Memcachedリフレクション攻撃

###### SNMPリフレクション攻撃

###### その他

###### リフレクション攻撃の増幅率

#### ボットネット

##### ファスト・フラックス

##### ダブル・フラックス

## 攻撃に使われるツール

### スキャナ

#### ホスト・スキャン

#### ポート・スキャン

#### バナー・チェック

#### フィンガー・プリンティング

#### 脆弱性調査

### パケット・スニッファ

### エクスプロイット・キット

### C&Cサーバ

### ソーシャル・エンジニアリング

## まとめ

攻撃者の種類と目的

攻撃の流れを表すフレームワーク

攻撃の種類

攻撃の手法

攻撃に使われるツール
